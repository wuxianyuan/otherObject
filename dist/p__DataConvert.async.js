(self.webpackChunk=self.webpackChunk||[]).push([[327],{80624:function(Y,g,l){"use strict";l.r(g),l.d(g,{default:function(){return C}});var D=l(54306),y=l.n(D),h=l(93236),c=l(57213),s=l.n(c),x=l(21140),S=l.n(x),j=l(63466),G=l.n(j),k=l(52510),b=l.n(k),f=l(64221),p=function(){function d(){S()(this,d),b()(this,"wb",void 0)}return G()(d,[{key:"readFile",value:function(n){var t=this;return new Promise(function(u,e){t.file_to_wb(n,function(a){t.wb=a,u({sj_tj_sj:t.getSjTjSjData(),qs_sdl:t.getMainTargetData("\u552E\u7535\u91CF"),gds:t.getGdsData("\u552E\u7535\u91CF"),dialog_content:t.getDialogContentData(),gqx:t.getGqxData("\u552E\u7535\u91CF"),gGds:t.getGGdsData("\u552E\u7535\u91CF"),dayTrend:t.getDayTrendData("\u552E\u7535\u91CF"),monthTrend:t.getMonthTrendData("\u552E\u7535\u91CF"),fcy:t.getFcyData("\u552E\u7535\u91CF"),zzy:t.getZzyData("\u552E\u7535\u91CF"),dt_gd:t.getDtGdData(),gd_total:t.getGdTotalData(),yy_xx_gx:t.getYyXxGxData(),yy_zh_zz:t.getYyGlXsData(),gd_gz:t.getGdGzData(),jc_fx:t.getJcFxData(),yy_zb:t.getYyZbData(),zb_yd:t.getZbYdData(),yj_xx:t.getYjXxData(),xzQhNameMapping:t.getNameMapping(),gs_zb:t.getGsZbData(),zb_date:t.getZbDateData()})})})}},{key:"file_to_wb",value:function(n,t){var u=new FileReader;u.onload=function(e){t((0,f.ij)(e.target.result))},u.readAsArrayBuffer(n)}},{key:"getSheetData",value:function(n){return f.P6.sheet_to_json(this.wb.Sheets[n])}},{key:"getSjTjSjData",value:function(){var n=this.getSheetData("\u5927\u5C4F\u66F4\u65B0\u65F6\u95F4")[0];return{name:n?"".concat(Object.keys(n)[0],"\uFF1A"):"",value:n?n[Object.keys(n||{})[0]]:""}}},{key:"getMainTargetData",value:function(n){var t=this.getSheetData("\u6307\u6807\u7A7F\u900F\u5206\u6790(\u4E3B\u6307\u6807\u57FA\u672C\u4FE1\u606F)"),u=this.getSheetData("\u6307\u6807\u7A7F\u900F\u5206\u6790(\u4E3B\u6307\u6807\u9884\u8B66\u4FE1\u606F)"),e=t.find(function(r){return r.\u6307\u6807\u540D\u79F0===n}),a=u.filter(function(r){return r.\u6307\u6807\u540D\u79F0===n});return s()(s()({},e),{},{\u662F\u5426\u662F\u540C\u6BD4\u4E0B\u964D:e.\u662F\u5426\u662F\u540C\u6BD4\u4E0B\u964D==="\u662F",\u662F\u5426\u662F\u73AF\u6BD4\u4E0B\u964D:e.\u662F\u5426\u662F\u73AF\u6BD4\u4E0B\u964D==="\u662F",\u9884\u8B66\u4FE1\u606F:(a==null?void 0:a.map(function(r){return{name:r.\u9884\u8B66\u63CF\u8FF0,value:r.\u9884\u8B66\u503C,color:r.\u503C\u989C\u8272}}))||[]})}},{key:"getGdsData",value:function(n){var t,u=this.getSheetData("\u6307\u6807\u7A7F\u900F\u5206\u6790(\u5404\u5730\u5E02)");return((t=u.filter(function(e){return e.\u6307\u6807\u540D\u79F0===n}))===null||t===void 0?void 0:t.map(function(e){return{xAxis:e.\u5730\u5E02,val:e.\u6307\u6807\u503C,yoy:e.\u540C\u6BD4,unit:e.\u5355\u4F4D}}))||[]}},{key:"getDialogContentData",value:function(){return this.getSheetData("\u5F39\u7A97\u63D0\u793A\u4FE1\u606F")[0]}},{key:"getGqxData",value:function(n){var t,u=this.getSheetData("\u6307\u6807\u7A7F\u900F\u5206\u6790(\u5404\u533A\u53BF)");return((t=u.filter(function(e){return e.\u6307\u6807\u540D\u79F0===n}))===null||t===void 0?void 0:t.reduce(function(e,a){return e[a.\u5730\u5E02]=e[a.\u5730\u5E02]||[],e[a.\u5730\u5E02].push({xAxis:a.\u533A\u53BF,val:a.\u6307\u6807\u503C,yoy:a.\u540C\u6BD4,unit:a.\u5355\u4F4D}),e},{}))||{}}},{key:"getGGdsData",value:function(n){var t,u=this.getSheetData("\u6307\u6807\u7A7F\u900F\u5206\u6790(\u5404\u4F9B\u7535\u6240)");return((t=u.filter(function(e){return e.\u6307\u6807\u540D\u79F0===n}))===null||t===void 0?void 0:t.reduce(function(e,a){return e[a.\u533A\u53BF]=e[a.\u533A\u53BF]||[],e[a.\u533A\u53BF].push({xAxis:a.\u4F9B\u7535\u5355\u4F4D,val:a.\u6307\u6807\u503C,yoy:a.\u540C\u6BD4,unit:a.\u5355\u4F4D}),e},{}))||{}}},{key:"getDayTrendData",value:function(n){var t,u=this.getSheetData("\u6307\u6807\u591A\u7EF4\u5206\u6790(\u65E5\u8D8B\u52BF)");return((t=u.filter(function(e){return e.\u6307\u6807\u540D\u79F0===n}))===null||t===void 0?void 0:t.reduce(function(e,a){return e[a.\u5730\u5E02]=e[a.\u5730\u5E02]||[],e[a.\u5730\u5E02].push({xAxis:a.\u65F6\u95F4,val:a.\u6307\u6807\u503C,yoy:a.\u540C\u6BD4,unit:a.\u5355\u4F4D}),e},{}))||{}}},{key:"getMonthTrendData",value:function(n){var t,u=this.getSheetData("\u6307\u6807\u591A\u7EF4\u5206\u6790(\u6708\u8D8B\u52BF)");return((t=u.filter(function(e){return e.\u6307\u6807\u540D\u79F0===n}))===null||t===void 0?void 0:t.reduce(function(e,a){return e[a.\u5730\u5E02]=e[a.\u5730\u5E02]||[],e[a.\u5730\u5E02].push({xAxis:a.\u65F6\u95F4,val:a.\u6307\u6807\u503C,yoy:a.\u540C\u6BD4,unit:a.\u5355\u4F4D}),e},{}))||{}}},{key:"getFcyData",value:function(n){var t,u=this.getSheetData("\u6307\u6807\u591A\u7EF4\u5206\u6790(\u5206\u4EA7\u4E1A)");return((t=u.filter(function(e){return e.\u6307\u6807\u540D\u79F0===n}))===null||t===void 0?void 0:t.reduce(function(e,a){return e[a.\u5730\u5E02]=e[a.\u5730\u5E02]||[],e[a.\u5730\u5E02].push({xAxis:a.\u4EA7\u4E1A,val:a.\u6307\u6807\u503C,yoy:a.\u540C\u6BD4,unit:a.\u5355\u4F4D}),e},{}))||{}}},{key:"getZzyData",value:function(n){var t,u=this.getSheetData("\u6307\u6807\u591A\u7EF4\u5206\u6790(\u5236\u9020\u4E1A\u5341\u5927\u91CD\u70B9\u884C\u4E1A)");return((t=u.filter(function(e){return e.\u6307\u6807\u540D\u79F0===n}))===null||t===void 0?void 0:t.reduce(function(e,a){return e[a.\u5730\u5E02]=e[a.\u5730\u5E02]||[],e[a.\u5730\u5E02].push({xAxis:a.\u884C\u4E1A,val:a.\u6307\u6807\u503C,yoy:a.\u540C\u6BD4,unit:a.\u5355\u4F4D}),e},{}))||{}}},{key:"getDtGdData",value:function(){var n=this.getSheetData("\u5730\u56FE\u9884\u8B66\u6570\u636E");return(n==null?void 0:n.reduce(function(t,u){return t[u.\u5730\u5E02]=t[u.\u5730\u5E02]||{},t[u.\u5730\u5E02]=u,t},{}))||{}}},{key:"getGdTotalData",value:function(){var n=this.getSheetData("\u5730\u56FE\u4E0A\u65B9\u9884\u8B66\u7EDF\u8BA1\u6570\u636E");return n[0]||{}}},{key:"getYyXxGxData",value:function(){var n=this.getSheetData("\u8FD0\u8425\u4FE1\u606F\u5171\u4EAB");return n[0]||{}}},{key:"getYyGlXsData",value:function(){var n=this.getSheetData("\u8FD0\u8425\u7BA1\u7406\u534F\u5546");return n[0]||{}}},{key:"getGdGzData",value:function(){var n=this.getSheetData("\u5DE5\u5355\u8DDF\u8E2A(\u6C47\u603B\u7EDF\u8BA1)"),t=this.getSheetData("\u5DE5\u5355\u8DDF\u8E2A(\u5217\u8868)");return(n==null?void 0:n.reduce(function(u,e){return u[e.\u5730\u5E02]=s()(s()({},e),{},{\u5DE5\u5355\u5217\u8868:t.filter(function(a){return a.\u5730\u5E02===e.\u5730\u5E02})}),u},{}))||{}}},{key:"getJcFxData",value:function(){var n=this.getSheetData("\u68C0\u6D4B\u5206\u6790");return n[0]||{}}},{key:"getYyZbData",value:function(){var n=this.getSheetData("\u8FD0\u8425\u6307\u6807");return(n==null?void 0:n.reduce(function(t,u){return t[u.\u5730\u5E02]=t[u.\u5730\u5E02]||[],t[u.\u5730\u5E02].push(s()(s()({},u),{},{\u662F\u5426\u540C\u6BD4\u4E0A\u5347:u.\u662F\u5426\u540C\u6BD4\u4E0A\u5347==="\u662F",\u662F\u5426\u540C\u6BD4\u6B63\u5E38:u.\u662F\u5426\u540C\u6BD4\u6B63\u5E38==="\u662F"?!0:u.\u662F\u5426\u540C\u6BD4\u6B63\u5E38==="\u5426"?!1:null,\u662F\u5426\u73AF\u6BD4\u4E0A\u5347:u.\u662F\u5426\u73AF\u6BD4\u4E0A\u5347==="\u662F",\u662F\u5426\u73AF\u6BD4\u6B63\u5E38:u.\u662F\u5426\u73AF\u6BD4\u6B63\u5E38==="\u662F"?!0:u.\u662F\u5426\u73AF\u6BD4\u6B63\u5E38==="\u5426"?!1:null,\u662F\u5426\u663E\u793A\u7D2F\u8BA1\u503C\u5355\u4F4D:u.\u662F\u5426\u663E\u793A\u7D2F\u8BA1\u503C\u5355\u4F4D==="\u662F",\u9884\u8B66:u.\u662F\u5426\u9884\u8B66==="\u662F",\u662F\u5426\u4E3A\u5F53\u65E5\u9884\u8B66:u.\u662F\u5426\u4E3A\u5F53\u65E5\u9884\u8B66==="\u662F",\u540C\u73AF\u6BD4\u5355\u4F4D:u.\u540C\u73AF\u6BD4\u5355\u4F4D||"%"})),t},{}))||{}}},{key:"getZbYdData",value:function(){var n=this.getSheetData("\u6307\u6807\u9884\u8B66");return n.map(function(t){var u,e,a=(u=Object.keys(t))===null||u===void 0||(e=u.filter(function(r){return r.includes("\u989C\u8272")}))===null||e===void 0?void 0:e.map(function(r){return r.replace("\u989C\u8272","")});return{text:t.\u5185\u5BB9,value:a==null?void 0:a.reduce(function(r,o){return r[o]={value:t[o],color:t["".concat(o,"\u989C\u8272")]},r},{})}})}},{key:"getYjXxData",value:function(){var n=this.getSheetData("\u6C14\u8C61\u9884\u8B66");return n.map(function(t){var u,e,a=(u=Object.keys(t))===null||u===void 0||(e=u.filter(function(r){return r.includes("\u989C\u8272")}))===null||e===void 0?void 0:e.map(function(r){return r.replace("\u989C\u8272","")});return{text:t.\u5185\u5BB9,value:a==null?void 0:a.reduce(function(r,o){return r[o]={value:t[o],color:t["".concat(o,"\u989C\u8272")]},r},{})}})}},{key:"getNameMapping",value:function(){return this.getSheetData("\u884C\u653F\u533A\u5212\u540D\u79F0\u6620\u5C04").reduce(function(n,t){return n[t.\u884C\u653F\u533A\u5212\u540D\u79F0]=t.\u7535\u529B\u516C\u53F8\u540D\u79F0,n},{})}},{key:"getGsZbData",value:function(){return this.getSheetData("\u516C\u53F8\u6307\u6807")||[]}},{key:"getZbDateData",value:function(){var n=this.getSheetData("\u6307\u6807\u6570\u636E\u65F6\u95F4");return(n==null?void 0:n.reduce(function(t,u){return t[u.\u6307\u6807\u540D\u79F0]=t[u.\u6307\u6807\u540D\u79F0]||{},t[u.\u6307\u6807\u540D\u79F0][u.\u7EF4\u5EA6]=u.\u6570\u636E\u65F6\u95F4,t},{}))||{}}}]),d}(),v=l(62086),T=function(i){var n=new p,t=(0,h.useState)(""),u=y()(t,2),e=u[0],a=u[1];return(0,v.jsxs)("div",{className:"flex flex-col w-[100vw] h-[100vh] p-[40px]",children:[(0,v.jsx)("input",{type:"file",onChange:function(o){n.readFile(o.target.files[0]).then(function(z){a("window.$staticData = ".concat(JSON.stringify(z,null,2)))})}}),(0,v.jsx)("div",{contentEditable:!0,className:"flex-1 mt-[20px] bg-red-100 overflow-hidden text-[#000]",children:(0,v.jsx)("div",{className:"h-full w-full overflow-auto",children:e})})]})},C=T},24863:function(){}}]);
